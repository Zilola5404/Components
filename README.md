# Компонент "Список жителей с домами" для 1С-Битрикс

## Для чего нужен этот компонент?

Данный компонент предназначен для вывода **списка жителей** с информацией о их домах на сайте, работающем на 1С-Битрикс. Он позволяет:
- Показывать ФИО жителя и адрес его дома (город, улица, номер)
- Использовать удобную постраничную навигацию (пагинацию)
- Работать быстро даже с большим количеством данных (есть кеширование и AJAX-подгрузка страниц)

### Пример вывода:
```
Иванов Иван - Москва, Ленина, 1
Петров Петр - Самара, Пушкина, 5
[1] [2] [3] ...  // пагинация
```

---

## Какие инфоблоки нужно создать?

### 1. Инфоблок "Жители" (код: `Residents`)
- **Тип инфоблока:** Контент (или любой другой, по вашему выбору)
- **Код инфоблока:** `Residents`
- **Свойства:**
  - `FIO` (строка) — ФИО жителя
  - `HOME` (привязка к элементу) — связь с инфоблоком "Дома"

### 2. Инфоблок "Дома" (код: `Homes`)
- **Тип инфоблока:** Контент (или любой другой, по вашему выбору)
- **Код инфоблока:** `Homes`
- **Свойства:**
  - `NUMBER` (строка) — номер дома
  - `STREET` (строка) — название улицы
  - `CITY` (строка) — название города

> **Важно:**
> - Коды инфоблоков (`Residents`, `Homes`) и коды свойств (`FIO`, `HOME`, `NUMBER`, `STREET`, `CITY`) должны быть написаны латиницей и совпадать с указанными выше.
> - Свойство `HOME` в "Жителях" должно быть типа "Привязка к элементу" и ссылаться на инфоблок "Дома".

---

## Как подключить компонент на страницу?

Вставьте следующий код в нужное место шаблона или страницы:

```php
<?php
$APPLICATION->IncludeComponent(
    "zilola:residentslist",
    "",
    [
        // Можно не указывать, если коды инфоблоков стандартные:
        // "RESIDENTS_IBLOCK_CODE" => "residents",
        // "HOMES_IBLOCK_CODE" => "homes",
        "PAGE_SIZE" => 3, // Сколько жителей на странице
        "CACHE_TIME" => 3600 // Время кеша в секундах
    ]
);
?>
```

---

## Как работает AJAX-пагинация?

- При клике по номерам страниц или стрелкам пагинации страница **не перезагружается** — обновляется только список жителей.
- Это реализовано с помощью встроенного JS-кода в шаблоне компонента.
- Если хотите обычную пагинацию с перезагрузкой — просто удалите JS-код из шаблона.

---

## Как работает кеширование?

- Для обычных (не-AJAX) запросов компонент использует кеш Bitrix (по умолчанию 3600 секунд).
- Для AJAX-запросов кеш отключён, чтобы всегда получать актуальные данные.

---

## Как изменить внешний вид?

- Измените файл шаблона компонента: `templates/.default/template.php`
- Можно добавить стили, классы, изменить структуру вывода по своему вкусу.

---

## Возможные проблемы и решения

- **Не выводятся данные:**
  - Проверьте, что инфоблоки и свойства созданы с правильными кодами.
  - Проверьте, что у жителей заполнены ФИО и привязка к дому, а у домов — все нужные свойства.
- **Пагинация странно работает:**
  - Проверьте, что у вас достаточно элементов для нескольких страниц.
  - Если используете AJAX, убедитесь, что JS-код не удалён из шаблона.
- **Стили пагинации не применяются:**
  - Используйте стандартные шаблоны Bitrix для пагинации или добавьте свои стили.

---

## Кратко о структуре файлов

- `class.php` — основная логика компонента (выборка, кеш, AJAX)
- `templates/.default/template.php` — шаблон вывода списка и пагинации
- `.parameters.php` — параметры компонента
- `README.md` — эта инструкция

---

## Вопросы?
Если что-то не работает или нужно доработать компонент — пишите разработчику или в поддержку вашего сайта! 
